service: kookmin-feed-crawling-server

provider:
  name: aws
  runtime: python3.11
  region: ap-northeast-2
  profile: kookmin-feed
  timeout: 30
  memorySize: 512
  iam:
    role:
      statements:
        - Effect: Allow
          Action: "*"
          Resource: "*"
  environment:
    MONGODB_URI: ${file(envs/config.${self:provider.stage, 'dev'}.json):MONGODB_URI}
    DB_NAME: ${file(envs/config.${self:provider.stage, 'dev'}.json):DB_NAME}
    SLACK_BOT_TOKEN: ${file(envs/config.${self:provider.stage, 'dev'}.json):SLACK_BOT_TOKEN}
    SLACK_CHANNEL_ID: ${file(envs/config.${self:provider.stage, 'dev'}.json):SLACK_CHANNEL_ID}

package:
  individually: false
  patterns:
    - 'common_utils.py'
    - 'master_handler.py'
    - 'master_utils.py'
    - 'metadata/**'
    - 'lambda_web_scraper/**'
    - '!node_modules/**'
    - '!package*.json'
    - '!README.md'
    - '!legacy_web_scraper/**'
    - '!layer/**'
    - '!envs/**'
    - '!.git/**'
    - '!.gitignore'
    - '!requirements.txt'
    - '!.vscode/**'
    - '!__pycache__/**'
    - '!**/__pycache__/**'

layers:
  ScraperDependencies:
    path: layer
    name: scraper-dependencies
    description: "웹 스크래퍼용 공통 Python 의존성 (bs4, aiohttp, pymongo, pytz, feedparser)"
    compatibleRuntimes:
      - python3.11

functions:
  # Master 함수
  master:
    name: master
    handler: master_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }
    events:
      - schedule:
          rate: rate(1 minute)
          enabled: true

  # University Academic 스크래퍼
  university_academic_scraper:
    name: university_academic_scraper
    handler: lambda_web_scraper.university_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Business Administration Academic RSS 스크래퍼
  businessadministration_academic_rss_scraper:
    name: businessadministration_academic_rss_scraper
    handler: lambda_web_scraper.businessadministration_academic_rss_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # University Special Lecture 스크래퍼
  university_speciallecture_scraper:
    name: university_speciallecture_scraper
    handler: lambda_web_scraper.university_speciallecture_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # University Scholarship 스크래퍼
  university_scholarship_scraper:
    name: university_scholarship_scraper
    handler: lambda_web_scraper.university_scholarship_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # University Contest Event 스크래퍼
  university_contestevent_scraper:
    name: university_contestevent_scraper
    handler: lambda_web_scraper.university_contestevent_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Software Centered Academic 스크래퍼
  softwarecentered_academic_scraper:
    name: softwarecentered_academic_scraper
    handler: lambda_web_scraper.softwarecentered_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Social Science Sociology Academic 스크래퍼
  socialscience_sociology_academic_scraper:
    name: socialscience_sociology_academic_scraper
    handler: lambda_web_scraper.socialscience_sociology_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # COSS Academic 스크래퍼
  coss_academic_scraper:
    name: coss_academic_scraper
    handler: lambda_web_scraper.coss_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Social Science Public Administration Academic 스크래퍼
  socialscience_publicadministration_academic_scraper:
    name: socialscience_publicadministration_academic_scraper
    handler: lambda_web_scraper.socialscience_publicadministration_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Social Science Political Science Academic 스크래퍼
  socialscience_politicalscience_academic_scraper:
    name: socialscience_politicalscience_academic_scraper
    handler: lambda_web_scraper.socialscience_politicalscience_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Social Science Education Academic 스크래퍼
  socialscience_education_academic_scraper:
    name: socialscience_education_academic_scraper
    handler: lambda_web_scraper.socialscience_education_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Social Science Communication Media Academic 스크래퍼
  socialscience_communication_media_academic_scraper:
    name: socialscience_communication_media_academic_scraper
    handler: lambda_web_scraper.socialscience_communication_media_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Social Science Communication Advertising Academic 스크래퍼
  socialscience_communication_advertising_academic_scraper:
    name: socialscience_communication_advertising_academic_scraper
    handler: lambda_web_scraper.socialscience_communication_advertising_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Social Science Academic 스크래퍼
  socialscience_academic_scraper:
    name: socialscience_academic_scraper
    handler: lambda_web_scraper.socialscience_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Science Technology Security Academic 스크래퍼
  sciencetechnology_security_academic_scraper:
    name: sciencetechnology_security_academic_scraper
    handler: lambda_web_scraper.sciencetechnology_security_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Science Technology Chemistry Academic 스크래퍼
  sciencetechnology_chemistry_academic_scraper:
    name: sciencetechnology_chemistry_academic_scraper
    handler: lambda_web_scraper.sciencetechnology_chemistry_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Physical Education Academic 스크래퍼
  physicaleducation_academic_scraper:
    name: physicaleducation_academic_scraper
    handler: lambda_web_scraper.physicaleducation_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Architecture Academic 스크래퍼
  architecture_academic_scraper:
    name: architecture_academic_scraper
    handler: lambda_web_scraper.architecture_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Arts Academic 스크래퍼
  arts_academic_scraper:
    name: arts_academic_scraper
    handler: lambda_web_scraper.arts_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Automative Engineering Academic 스크래퍼
  automativeengineering_academic_scraper:
    name: automativeengineering_academic_scraper
    handler: lambda_web_scraper.automativeengineering_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Creative Engineering Advanced Materials Academic 스크래퍼
  creativeengineering_advancedmaterials_academic_scraper:
    name: creativeengineering_advancedmaterials_academic_scraper
    handler: lambda_web_scraper.creativeengineering_advancedmaterials_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Creative Engineering Civil Academic 스크래퍼
  creativeengineering_civil_academic_scraper:
    name: creativeengineering_civil_academic_scraper
    handler: lambda_web_scraper.creativeengineering_civil_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Creative Engineering Mechanical Academic 스크래퍼
  creativeengineering_mechanical_academic_scraper:
    name: creativeengineering_mechanical_academic_scraper
    handler: lambda_web_scraper.creativeengineering_mechanical_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Design Automotive Academic 스크래퍼
  design_automotive_academic_scraper:
    name: design_automotive_academic_scraper
    handler: lambda_web_scraper.design_automotive_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Design Ceramics Academic 스크래퍼
  design_ceramics_academic_scraper:
    name: design_ceramics_academic_scraper
    handler: lambda_web_scraper.design_ceramics_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Design Industrial Academic 스크래퍼
  design_industrial_academic_scraper:
    name: design_industrial_academic_scraper
    handler: lambda_web_scraper.design_industrial_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Design Metalwork Academic 스크래퍼
  design_metalwork_academic_scraper:
    name: design_metalwork_academic_scraper
    handler: lambda_web_scraper.design_metalwork_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Design Visual Academic 스크래퍼
  design_visual_academic_scraper:
    name: design_visual_academic_scraper
    handler: lambda_web_scraper.design_visual_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Future Mobility Academic 스크래퍼
  futuremobility_academic_scraper:
    name: futuremobility_academic_scraper
    handler: lambda_web_scraper.futuremobility_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Global Humanities Eurasian Academic 스크래퍼
  globalhumanities_eurasian_academic_scraper:
    name: globalhumanities_eurasian_academic_scraper
    handler: lambda_web_scraper.globalhumanities_eurasian_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Law Academic 스크래퍼
  law_academic_scraper:
    name: law_academic_scraper
    handler: lambda_web_scraper.law_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # LINC Academic 스크래퍼
  linc_academic_scraper:
    name: linc_academic_scraper
    handler: lambda_web_scraper.linc_academic_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # NCCOSS General 스크래퍼
  nccoss_general_scraper:
    name: nccoss_general_scraper
    handler: lambda_web_scraper.nccoss_general_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Computer Science Academic RSS 스크래퍼
  computerscience_academic_rss_scraper:
    name: computerscience_academic_rss_scraper
    handler: lambda_web_scraper.computerscience_academic_rss_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Creative Engineering Electrical Academic RSS 스크래퍼
  creativeengineering_electrical_academic_rss_scraper:
    name: creativeengineering_electrical_academic_rss_scraper
    handler: lambda_web_scraper.creativeengineering_electrical_academic_rss_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Global Humanities Korean History Academic RSS 스크래퍼
  globalhumanities_koreanhistory_academic_rss_scraper:
    name: globalhumanities_koreanhistory_academic_rss_scraper
    handler: lambda_web_scraper.globalhumanities_koreanhistory_academic_rss_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Dormitory General RSS 스크래퍼
  dormitory_general_rss_scraper:
    name: dormitory_general_rss_scraper
    handler: lambda_web_scraper.dormitory_general_rss_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Economic Commerce Academic RSS 스크래퍼
  economiccommerce_academic_rss_scraper:
    name: economiccommerce_academic_rss_scraper
    handler: lambda_web_scraper.economiccommerce_academic_rss_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }

  # Creative Engineering Academic RSS 스크래퍼
  creativeengineering_academic_rss_scraper:
    name: creativeengineering_academic_rss_scraper
    handler: lambda_web_scraper.creativeengineering_academic_rss_handler.handler
    layers:
      - { Ref: ScraperDependenciesLambdaLayer }